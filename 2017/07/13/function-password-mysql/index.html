<!DOCTYPE html><html lang="en-us"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Mysql Password 함수 | {bbon}</title><meta name="description"><meta name="generator" content="{bbon}"><meta name="author" content="bbon"><meta name="keywords" content="developer, .net xamarin aspnetcore c#"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=0"><link rel="stylesheet" type="text/css" href="/styles/screen.css"><link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/images/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-180x180.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png"><link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160x160.png"><link rel="icon" type="image/png" sizes="192x192" href="/images/favicon-192x192.png"><meta name="msapplication-TileColor" content="#121315"><meta name="msapplication-TileImage" content="/images/mstile-144x144.png"><link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml"></head><body itemscope itemtype="https://schema.org/WebPage"><header itemscope itemtype="https://schema.org/WPHeader"><a href="/"><img src="/images/svdb.png" alt="{bbon}" title="{bbon}"></a><h1><a href="/" alt="{bbon}" title="{bbon}" itemprop="headline">{bbon}</a></h1><p itemprop="description"></p><nav itemscope itemtype="https://schema.org/SiteNavigationElement"><ul><li itemprop="name"><a href="/" alt="Home" title="Home" itemprop="url">Home</a></li><li itemprop="name"><a href="/articles" alt="Articles" title="Articles" itemprop="url">Articles</a></li><li itemprop="name"><a href="/about" alt="About" title="About" itemprop="url">About</a></li></ul></nav><div class="space"></div></header><main itemscope itemtype="https://schema.org/Blog"><article class="full"><h1 itemprop="headline">Mysql Password 함수</h1><span class="post-meta">Published on<time itemprop="datePublished" datetime="2017-07-12T15:00:00.000Z"> 목요일, 7월 13일 2017 at 0:00</time><br>Last updated on<time itemprop="dateModified" datetime="2017-07-12T15:00:00.000Z"> 목요일, 1월 3일 2019 at 13:35</time></span><p>MySql 의 PASSWORD 함수는 해시값을 계산한 문자열을 반환하는 함수입니다.</p>
<p>비밀번호를 처리할 때 많이 사용됩니다. 실제 서버의 계정 비밀번호도 PASSWORD 함수를 사용해서 처리하게 됩니다.</p>
<blockquote>
<p>주의<br>
해시가 계산된 값이 4.1.0 이전 버전과 4.1.1 이후 버전이 다릅니다.<br>
<a href="https://dev.mysql.com/doc/refman/5.7/en/password-hashing.html" target="_blank" rel="noopener">Password Hashing in MySQL</a> 페이지 참조하십시오.</p>
</blockquote>
<p>4.1.1 이후 버전에서 PASSWORD 함수 결과는 아래와 같습니다.<br>
결과는 문자열입니다.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MYSQL&gt; select password('hello');</span><br></pre></td></tr></table></figure>
<blockquote>
<p>결과<br>
<code>*6B4F89A54E2D27ECD7E8DA05B4AB8FD9D1D8B119</code></p>
</blockquote>
<p>PASSWORD 함수의 동작에 대한 내용을 <a href="https://www.pythian.com/blog/hashing-algorithm-in-mysql-password-2/" target="_blank" rel="noopener">HASHING ALGORITHM IN MYSQL PASSWORD()</a> 페이지에서 찾을 수 있습니다.</p>
<p>위 링크 페이지의 내용에서는 아래와 같이 동일한 값을 얻을 수 있다고 합니다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MYSQL&gt; select password('hello') as result</span><br><span class="line">union all</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">concat</span>(<span class="string">'*'</span>, <span class="keyword">convert</span>(<span class="keyword">sha1</span>(<span class="keyword">unhex</span>(<span class="keyword">sha1</span>(<span class="string">'hello'</span>))) <span class="keyword">USING</span> utf8));</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>*6B4F89A54E2D27ECD7E8DA05B4AB8FD9D1D8B119</code><br>
<code>*6b4f89a54e2d27ecd7e8da05b4ab8fd9d1d8b119</code></p>
</blockquote>
<p>password 함수는 sha1 해시 값을 다시 sha1 해시 값을 계산한 값을 문자열로 표현하고, ‘<code>*</code>’ 을 앞에 붙인 것과 동일합니다.</p>
<p>기존 시스템이 MySql 로 운영되고 있을 때, 이를 다른 DBMS로 이관을 해야하면 문자열을 그대로 이관하고, PASSWORD 함수와 동일한 동작을 할 수 있는 해시 함수를 작성해서 처리할 수 있습니다.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">GenerateMySQLHash</span>(<span class="params"><span class="keyword">string</span> key</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">byte</span>[] keyArray = Encoding.UTF8.GetBytes(key);</span><br><span class="line">    SHA1Managed enc = <span class="keyword">new</span> SHA1Managed();</span><br><span class="line">    <span class="keyword">byte</span>[] encodedKey = enc.ComputeHash(enc.ComputeHash(keyArray));</span><br><span class="line">    StringBuilder myBuilder = <span class="keyword">new</span> StringBuilder(encodedKey.Length);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">byte</span> b <span class="keyword">in</span> encodedKey)</span><br><span class="line">    &#123;</span><br><span class="line">        myBuilder.Append(b.ToString(<span class="string">"X2"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"*"</span> + myBuilder.ToString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GenerateMySQLHash(<span class="string">'hello'</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>결과<br>
<code>*6B4F89A54E2D27ECD7E8DA05B4AB8FD9D1D8B119</code></p>
</blockquote>
</article></main></body></html>