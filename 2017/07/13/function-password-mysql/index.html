<!DOCTYPE html><html lang="ko" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Mysql Password 함수 · {bbon}</title><meta name="description"><meta name="og:title" content="Mysql Password 함수"><meta name="og:type" content="website"><meta name="og:url" content="http://bbon.me/2017/07/13/function-password-mysql/"><meta name="og:image" content="/images/logo.png"><meta name="og:description"><meta name="twitter:card" content="summary"><meta name="witter:site" content="@bbonkr"><meta name="witter:creator" content="@bbonkr"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/chiangmai.css"><link rel="stylesheet" href="/css/prism.css"><link rel="search" type="application/opensearchdescription+xml" href="http://bbon.me/atom.xml" title="{bbon}"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="{bbon}" type="application/atom+xml">
</head><body class="post"><div id="fb-root"></div><div class="wrap"><header><nav class="navi-post"><a class="navi-post-back" href="javascript:history.back()"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="navi-post-home" href="/"><i class="fa fa-home" aria-hidden="true"></i></a></nav></header><main class="post"><div class="post"><article class="post-block"><h1 class="post-title">Mysql Password 함수</h1><div class="post-info"><div class="post-info-profile"><a href="https://github.com/bbonkr" target="_blank"><img src="/images/me.png"></a></div><div class="post-info-details"><div class="post-categories"><a href="/categories/Computing" target="_self"><span>COMPUTING</span></a></div><div class="post-date">2017년 7월 13일</div></div></div><div class="post-share"><div class="fb-like" data-href="http://bbon.me/2017/07/13/function-password-mysql/" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="false">                 </div><div class="fb-share-button" data-href="http://bbon.me/2017/07/13/function-password-mysql/" data-layout="button" data-size="small" data-mobile-iframe="true"></div></div><div class="post-content"><p>MySql 의 PASSWORD 함수는 해시값을 계산한 문자열을 반환하는 함수입니다.</p>
<p>비밀번호를 처리할 때 많이 사용됩니다. 실제 서버의 계정 비밀번호도 PASSWORD 함수를 사용해서 처리하게 됩니다.</p>
<blockquote>
<p>주의<br>해시가 계산된 값이 4.1.0 이전 버전과 4.1.1 이후 버전이 다릅니다.<br><a href="https://dev.mysql.com/doc/refman/5.7/en/password-hashing.html" target="_blank" rel="noopener">Password Hashing in MySQL</a> 페이지 참조하십시오.</p>
</blockquote>
<p>4.1.1 이후 버전에서 PASSWORD 함수 결과는 아래와 같습니다.<br>결과는 문자열입니다.</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">MYSQL<span class="token operator">></span> <span class="token keyword">select</span> password<span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>결과<br><code>*6B4F89A54E2D27ECD7E8DA05B4AB8FD9D1D8B119</code></p>
</blockquote>
<p>PASSWORD 함수의 동작에 대한 내용을 <a href="https://www.pythian.com/blog/hashing-algorithm-in-mysql-password-2/" target="_blank" rel="noopener">HASHING ALGORITHM IN MYSQL PASSWORD()</a> 페이지에서 찾을 수 있습니다.</p>
<p>위 링크 페이지의 내용에서는 아래와 같이 동일한 값을 얻을 수 있다고 합니다.</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">MYSQL<span class="token operator">></span> <span class="token keyword">select</span> password<span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> result
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token keyword">convert</span><span class="token punctuation">(</span>sha1<span class="token punctuation">(</span>unhex<span class="token punctuation">(</span>sha1<span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> utf8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p><code>*6B4F89A54E2D27ECD7E8DA05B4AB8FD9D1D8B119</code><br><code>*6b4f89a54e2d27ecd7e8da05b4ab8fd9d1d8b119</code></p>
</blockquote>
<p>password 함수는 sha1 해시 값을 다시 sha1 해시 값을 계산한 값을 문자열로 표현하고, ‘<code>*</code>‘ 을 앞에 붙인 것과 동일합니다.</p>
<p>기존 시스템이 MySql 로 운영되고 있을 때, 이를 다른 DBMS로 이관을 해야하면 문자열을 그대로 이관하고, PASSWORD 함수와 동일한 동작을 할 수 있는 해시 함수를 작성해서 처리할 수 있습니다.</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GenerateMySQLHash</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> keyArray <span class="token operator">=</span> Encoding<span class="token punctuation">.</span>UTF8<span class="token punctuation">.</span><span class="token function">GetBytes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SHA1Managed</span> enc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SHA1Managed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> encodedKey <span class="token operator">=</span> enc<span class="token punctuation">.</span><span class="token function">ComputeHash</span><span class="token punctuation">(</span>enc<span class="token punctuation">.</span><span class="token function">ComputeHash</span><span class="token punctuation">(</span>keyArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">StringBuilder</span> myBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span>encodedKey<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">byte</span></span> b <span class="token keyword">in</span> encodedKey<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        myBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"X2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token string">"*"</span> <span class="token operator">+</span> myBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token function">GenerateMySQLHash</span><span class="token punctuation">(</span>'hello'<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>결과<br><code>*6B4F89A54E2D27ECD7E8DA05B4AB8FD9D1D8B119</code></p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2017/03/29/ios-10.3/"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="next" href="/2017/08/16/error-git-on-visual-studio-2017/"><i class="fa fa-arrow-right" aria-hidden="true"></i></a></div><div class="copyright"><p>© 2019 - 2021 <a href="https://github.com/bbonkr" target="_blank">bbon</a>. Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/stunstunstun/hexo-theme-chiangmai" target="_blank">hexo-theme-chiangmai</a>.</p></div></footer></div><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create','UA-64779499-1','auto');ga('send','pageview');</script></body></html>