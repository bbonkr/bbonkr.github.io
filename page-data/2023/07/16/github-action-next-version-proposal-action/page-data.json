{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2023/07/16/github-action-next-version-proposal-action","result":{"data":{"site":{"siteMetadata":{"title":"<bbon />","siteUrl":"https://bbon.me"}},"markdownRemark":{"id":"74f14e6e-eefc-53b2-856a-b3b6774d759e","excerpt":"개요 깃허브 워크플로우 중 PULL_REQUEST 이벤트에서 활용할 수 있는 액션입니다. 기본 브랜치로 병합이 지정된 풀 리퀘스트가 완료될 때, 기본 브랜치로 병합이 발생하는 경우 풀 리퀘스트의 라벨에 따라 다음 버전 이름을 제안합니다. 동작: 깃 태그 이름 중 SEMVER…","html":"<h2>개요</h2>\n<p>깃허브 워크플로우 중 PULL_REQUEST 이벤트에서 활용할 수 있는 액션입니다.</p>\n<p>기본 브랜치로 병합이 지정된 풀 리퀘스트가 완료될 때, 기본 브랜치로 병합이 발생하는 경우 풀 리퀘스트의 라벨에 따라 다음 버전 이름을 제안합니다.</p>\n<h2>동작:</h2>\n<p>깃 태그 이름 중 SEMVER<sup id=\"fnref-sember\"><a href=\"#fn-sember\" class=\"footnote-ref\">sember</a></sup> 형식의 태그 이름을 검색해서, 최신 버전에 해당하는 태그 이름을 찾습니다.</p>\n<p>SEMVER<sup id=\"fnref-sember\"><a href=\"#fn-sember\" class=\"footnote-ref\">sember</a></sup> 형식의 깃 태그를 찾을 수 없는 경우 <code class=\"language-text\">1.0.0</code> 을 제안합니다.</p>\n<p>최신 버전에 해당하는 깃 태그를 찾은 경우, 지정된 풀 리퀘스트에 지정되어 있는 라벨을 기준으로 주 버전, 부 버전, 패치 버전을 1 증가 시킨 버전 이름을 제안합니다.</p>\n<h2>입력과 출력</h2>\n<h3>입력</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Name</th>\n<th align=\"center\">Required</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">github_token</td>\n<td align=\"center\">✅</td>\n<td align=\"left\">깃허브 개인 인증 토큰 (PAT); 저장소 읽기 권한이 필요합니다.</td>\n</tr>\n<tr>\n<td align=\"left\">pr</td>\n<td align=\"center\">✅</td>\n<td align=\"left\">풀 리퀘스트 번호; 예) 100</td>\n</tr>\n<tr>\n<td align=\"left\">major_labels</td>\n<td align=\"center\">✅</td>\n<td align=\"left\">주 버전이 증가하는 풀리퀘스트 라벨 이름 목록; 쉼표로 구분</td>\n</tr>\n<tr>\n<td align=\"left\">minor_labels</td>\n<td align=\"center\">✅</td>\n<td align=\"left\">부 버전이 증가하는 풀리퀘스트 라벨 이름 목록; 쉼표로 구분</td>\n</tr>\n<tr>\n<td align=\"left\">patch_labels</td>\n<td align=\"center\">✅</td>\n<td align=\"left\">패치 버전이 증가하는 풀리퀘스트 라벨 이름 목록; 쉼표로 구분</td>\n</tr>\n<tr>\n<td align=\"left\">next_version_prefix</td>\n<td align=\"center\"></td>\n<td align=\"left\">다음 버전 이름 접두어</td>\n</tr>\n</tbody>\n</table>\n<p>현재 워크플로우가 실행되고 있는 저장소에 대한 작업인 경우 <code class=\"language-text\">github_token</code> 에 입력할 깃허브 개인 인증 토큰의 값은 미리 정의된 변수 중 하나를 사용할 수 있습니다.</p>\n<ul>\n<li><code class=\"language-text\">github.token</code></li>\n<li><code class=\"language-text\">secrets.GITHUB_TOKEN</code></li>\n</ul>\n<p>현재 워크플로우가 실행된 이벤트 트리거가 <code class=\"language-text\">pull_request</code> 인 경우 <code class=\"language-text\">pr</code> 에 입력할 풀 리퀘스트 번호의 값은 현재 컨텍스트의 이벤트 데이터를 사용할 수 있습니다.</p>\n<ul>\n<li>github.event.pull_request.number</li>\n</ul>\n<h3>출력</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Name</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">latest_version</td>\n<td align=\"left\">깃 태그에서 찾은 최신 버전 이름</td>\n</tr>\n<tr>\n<td align=\"left\">next_version</td>\n<td align=\"left\">제안된 다음 버전 이름</td>\n</tr>\n<tr>\n<td align=\"left\">next_version_major</td>\n<td align=\"left\">제안된 다음 버전의 주 버전</td>\n</tr>\n<tr>\n<td align=\"left\">next_version_minor</td>\n<td align=\"left\">제안된 다음 버전의 부 버전</td>\n</tr>\n<tr>\n<td align=\"left\">next_version_patch</td>\n<td align=\"left\">제안된 다음 버전의 패치 버전</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p><code class=\"language-text\">latest_version == ''</code> 인 경우 <code class=\"language-text\">next_version</code> 의 값은 <code class=\"language-text\">1.0.0</code> 입니다.</p>\n</blockquote>\n<h2>예제</h2>\n<p>아래 워크플로우는 메인 브랜치를 베이스로 하는 풀 리퀘스트가 병합으로 완료되면 실행됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'create-tag'</span>\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> main\n        <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> closed\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">get_next_version</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n        <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> github.event.pull_request.merged == true <span class=\"token comment\"># 풀 리퀘스트가 병합으로 완료된 상태를 확인</span>\n        <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\n              <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Get next version\n              <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> bbonkr/next<span class=\"token punctuation\">-</span>version<span class=\"token punctuation\">-</span>proposal<span class=\"token punctuation\">-</span>action@v1\n              <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> next_version_proposal\n              <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n                  <span class=\"token key atrule\">github_token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\"># 깃허브 개인 인증 토큰</span>\n                  <span class=\"token key atrule\">pr</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.event.pull_request.number <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\"># 연관 풀 리퀘스트 번호</span>\n                  <span class=\"token key atrule\">major_labels</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'major, next'</span> <span class=\"token comment\"># 주 버전이 증가하는 풀리퀘스트 라벨 이름 목록</span>\n                  <span class=\"token key atrule\">minor_labels</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'enhancement, feature'</span> <span class=\"token comment\"># 부 버전이 증가하는 풀리퀘스트 라벨 이름 목록</span>\n                  <span class=\"token key atrule\">patch_labels</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'bug, documentation, chore, dependencies'</span> <span class=\"token comment\"># 패치 버전이 증가하는 풀리퀘스트 라벨 이름 목록</span>\n                  <span class=\"token key atrule\">next_version_prefix</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'v'</span> <span class=\"token comment\"># 버전 이름의 접두어를 지정</span>\n\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> logging\n              <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n                  echo \"latest_version=${{ steps.next_version_proposal.outputs.latest_version }}\"\n                  echo \"next_version=${{ steps.next_version_proposal.outputs.next_version }}\"\n                  echo \"next_version_major=${{ steps.next_version_proposal.outputs.next_version_major }}\"\n                  echo \"next_version_minor=${{ steps.next_version_proposal.outputs.next_version_minor }}\"\n                  echo \"next_version_patch=${{ steps.next_version_proposal.outputs.next_version_patch }}\"</span></code></pre></div>\n<h2>제약사항:</h2>\n<ol>\n<li>SEMVER<sup id=\"fnref-sember\"><a href=\"#fn-sember\" class=\"footnote-ref\">sember</a></sup> 형식을 처리할 때, 주 버전 <small>major</small>, 부 버전 <small>minor</small>, 패치 버전 <small>patch</small> 부분에 대한 다음 버전을 제안합니다. 미리보기 <small>pre-release</small>, 빌드 번호 <small>build</small> 부분은 처리하지 않습니다.</li>\n</ol>\n<h2>관련 내용</h2>\n<ul>\n<li><a href=\"https://github.com/bbonkr/next-version-proposal-action\">GitHub: bbonkr/next-version-proposal-action</a></li>\n<li><a href=\"https://github.com/marketplace/actions/next-version-proposal-action\">GitHub marketplace: next-version-proposal-action</a></li>\n<li><a href=\"https://docs.github.com/en/actions/learn-github-actions/contexts#github-context\">GitHub actions: github-context</a></li>\n<li><a href=\"https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#pull_request\">GitHub workflows event trigger: pull_request</a></li>\n<li><a href=\"https://docs.github.com/en/actions/learn-github-actions/expressions#functions\">GitHub Actions: expression</a></li>\n<li><a href=\"https://docs.github.com/en/actions/using-workflows/using-github-cli-in-workflows\">GitHub CLI</a></li>\n<li><a href=\"https://docs.github.com/ko/rest/pulls/pulls?apiVersion=2022-11-28#list-pull-requests\">GitHub rest: list-pull-requests</a></li>\n<li><a href=\"https://docs.github.com/ko/rest/git/refs?apiVersion=2022-11-28#list-matching-references\">GitHub rest: list-matching-references</a></li>\n</ul>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-sember\"><a href=\"https://semver.org/\">https://semver.org/</a><a href=\"#fnref-sember\" class=\"footnote-backref\">↩</a></li>\n</ol>\n</div>","frontmatter":{"title":"Github Action: next-version-proposal-action","date":"2023-07-16","description":null,"categories":["blog","computing"],"tags":["github","github-actions","github-repository","typescript"],"github":{"owner":"bbonkr","repo":"next-version-proposal-action"},"featuredImage":null,"draft":false,"comments":false}},"previous":{"fields":{"slug":"/2023/05/09/using-keystone-for-app-backend/"},"frontmatter":{"title":"Using Keystone for app Backend","draft":null,"comments":false,"featuredImage":null}},"next":{"fields":{"slug":"/2023/09/10/automation-create-pull-request-using-github-workflows/"},"frontmatter":{"title":"깃허브 워크플로우를 활용한 자동 풀 리퀘스트 작성","draft":false,"comments":false,"featuredImage":null}}},"pageContext":{"id":"74f14e6e-eefc-53b2-856a-b3b6774d759e","previousPostId":"8a10cd1c-b37c-5e00-9618-a7c264bc0dd1","nextPostId":"e743d401-49d8-5aec-8929-ee997f4f7646"}},"staticQueryHashes":["2644450635","3199328057"],"slicesMap":{}}