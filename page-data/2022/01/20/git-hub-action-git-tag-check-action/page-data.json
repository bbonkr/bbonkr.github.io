{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2022/01/20/git-hub-action-git-tag-check-action/","result":{"data":{"site":{"siteMetadata":{"title":"<bbon />","siteUrl":"https://bbon.me"}},"markdownRemark":{"id":"8f7a99a4-7ded-51b8-9c46-6a5967d79729","excerpt":"깃허브 워크플로우에서 활용할 수 있는 깃허브 액션 GitHub actions 을 작성했습니다. 입력된 태그가 깃 git 원격저장소에 존재하는지 조회한 후 있으면 입력된 태그를 반환하고, 찾을 수 없으면 빈 문자열을 반환하는 단계를 제공합니다. View on Marketplace: git…","html":"<p>깃허브 워크플로우에서 활용할 수 있는 깃허브 액션 GitHub actions 을 작성했습니다.</p>\n<p>입력된 태그가 깃 git 원격저장소에 존재하는지 조회한 후 있으면 입력된 태그를 반환하고, 찾을 수 없으면 빈 문자열을 반환하는 단계를 제공합니다.</p>\n<p><a href=\"https://github.com/marketplace/actions/git-tag-check-action\"><img src=\"https://img.shields.io/badge/Marketplace-git--tag--check--action-blueviolet\" alt=\"View on Marketplace: git-tag-check-action\"></a> <a href=\"https://github.com/bbonkr/git-tag-check-action/releases\"><img src=\"https://img.shields.io/github/v/release/bbonkr/git-tag-check-action?display_name=tag&#x26;style=flat-square&#x26;include_prereleases\" alt=\"출시 버전\"></a></p>\n<h2>git-tag-check-action</h2>\n<h3>Overview</h3>\n<p>버전 관리를 할 때 버전이름으로 git tag 를 작성하고 있습니다.</p>\n<p>이 깃허브 액션은 현재 깃허브 저장소에 입력된 이름의 태그가 존재하는지 확인하는 작업에 도움이 될 수 있습니다.</p>\n<p>예상되는 사용처:</p>\n<ul>\n<li>워크플로우에서 현재 버젼이 존재하는 경우 이후 단계를 실행하지 않게 설정</li>\n</ul>\n<h3>Usages</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> bbonkr/git<span class=\"token punctuation\">-</span>tag<span class=\"token punctuation\">-</span>check<span class=\"token punctuation\">-</span>action@v1.0.5\n    <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> git_tag_check\n    <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">github_token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GITHUB_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">tag</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'v1.0.0'</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> logging found\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.git_tag_check.outputs.tag <span class=\"token tag\">!=</span> '' <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n      echo \"Found tag=${{ steps.git_tag_check.outputs.tag }}\"</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> logging not found\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.git_tag_check.outputs.tag == '' <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n      echo \"Tag does not exist\"   </span></code></pre></div>\n<h3>Inputs</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Name</th>\n<th align=\"center\">Required</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">tag</td>\n<td align=\"center\">✅</td>\n<td align=\"left\">태그, 확인하려는 태그입니다.</td>\n</tr>\n<tr>\n<td align=\"left\">github_token</td>\n<td align=\"center\">✅</td>\n<td align=\"left\">깃허브 PAT, Repo 스코프가 필요합니다.</td>\n</tr>\n<tr>\n<td align=\"left\">prefix</td>\n<td align=\"center\"></td>\n<td align=\"left\">버전 접두어입니다. 기본값은 <code class=\"language-text\">''</code> (빈 문자열)입니다.</td>\n</tr>\n</tbody>\n</table>\n<h3>Outputs</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Name</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">tag</td>\n<td align=\"left\">입력된 태그가 있는 경우 조회된 태그가 반환됩니다. 없는 경우 <code class=\"language-text\">''</code> (빈 문자열)입니다.</td>\n</tr>\n</tbody>\n</table>\n<h2>Review</h2>\n<h3>GitHub Action with typescript</h3>\n<p>node.js 기반으로 동작하고, Typescript로 작성된 액션입니다.</p>\n<p>처음 작성하는 액션이라, 어떻게 작성하는지 어떻게 게시하는지 확인을 하기 위해 <a href=\"https://github.com/actions/typescript-action\">GitHub: actions/typescript-action</a> 템플릿을 사용했습니다.</p>\n<h3>dist/index.js</h3>\n<p>액션 실행에 사용되는 시작점입니다.</p>\n<blockquote>\n<p>풀 리쿼스트 작성 또는 기본 브랜치로 커밋을 전송하기전에 <code class=\"language-text\">ncc build</code> 로 dist/ 디렉터리의 파일들을 다시 작성하고, 커밋한 후 풀 리퀘스트 작성 또는 원격 저장소에 커밋을 전송하는 방식을 사용하애 하는 것으로 생각됩니다. <code class=\"language-text\">npm run package</code> 스크립트로 실행이 준비되어져 있습니다.</p>\n</blockquote>\n<h3>src/main.ts</h3>\n<p>구현하고자 하는 코드의 시작점입니다.</p>\n<p><a href=\"https://www.npmjs.com/package/@actions/core\"><code class=\"language-text\">@actions/core</code></a> 패키지를 사용해서 깃허브 액션에 필요한 입력, 출력을 구현합니다.</p>\n<p><a href=\"https://www.npmjs.com/package/@actions/github\"><code class=\"language-text\">@actions/github</code></a> 패키지를 사용해서 GitHub 저장소 액세스(<code class=\"language-text\">Octokit</code>)를 구현할 수 있습니다.</p>\n<h3>GitHub Actions</h3>\n<p>깃허브 워크플로우가 미리 구성되어 있습니다.</p>\n<p><code class=\"language-text\">check-dist</code>, <code class=\"language-text\">test</code> 두 개의 워크플로우가 있습니다.</p>\n<p><code class=\"language-text\">check-dist</code> 는 dist/ 디렉터리에 있는 시작점 코드들이 현재 코드로 다시 작성되었는지 확인하는 워크프로우로 생각됩니다.</p>\n<p>그런데, 로컬 장치에서 매번 다시 작성해서 커밋을 원격 저장소에 전송했는데, 워크플로우가 실행되는 장치에서 빌드와 차이점이 발견되고 있어 항상 오류 발생으로 종료되고 있습니다.</p>\n<blockquote>\n<p>좀 더 확인해봐야할 필요가 있습니다.</p>\n</blockquote>\n<p><code class=\"language-text\">test</code> 워크플로우는 빌드를 확인하고, 단위 테스트를 실행하는 등의 작업이 실행되는 작업과 작성된 깃허브 액션을 실행해서 동작을 확인하는 작업으로 구성되어져 있습니다.</p>","frontmatter":{"title":"GitHub Action: Git Tag Check Action","date":"January 20, 2022","description":null,"categories":["blog","computing","repository"],"tags":["git","git-tag","github","github-actions","github-repository","node-js","nodejs","ts","typescript"],"github":{"owner":"bbonkr","repo":"git-tag-check-action"},"featuredImage":null,"draft":null,"comments":null}},"previous":{"fields":{"slug":"/2022/01/20/git-hub-action-get-version-action/"},"frontmatter":{"title":"GitHub Action: Get Version Action","draft":null,"comments":null,"featuredImage":null}},"next":{"fields":{"slug":"/2022/04/14/reduce-docker-image-size/"},"frontmatter":{"title":"Reduce docker image size","draft":null,"comments":false,"featuredImage":null}}},"pageContext":{"id":"8f7a99a4-7ded-51b8-9c46-6a5967d79729","previousPostId":"3c0f5a19-3575-53ce-95ef-2b0b837abd23","nextPostId":"c9b66ce3-0836-515b-bfe7-34a86dff1abe"}},"staticQueryHashes":["2644450635","3199328057"]}