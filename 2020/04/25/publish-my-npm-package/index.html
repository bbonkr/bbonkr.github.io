<!DOCTYPE html><html lang="ko" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>나의 NPM 패키지 만들기 · {bbon}</title><meta name="description"><meta name="og:title" content="나의 NPM 패키지 만들기"><meta name="og:type" content="website"><meta name="og:url" content="http://bbon.me/2020/04/25/publish-my-npm-package/"><meta name="og:image" content="/images/logo.png"><meta name="og:description"><meta name="twitter:card" content="summary"><meta name="witter:site" content="@bbonkr"><meta name="witter:creator" content="@bbonkr"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/chiangmai.css"><link rel="stylesheet" href="/css/prism.css"><link rel="search" type="application/opensearchdescription+xml" href="http://bbon.me/atom.xml" title="{bbon}"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="{bbon}" type="application/atom+xml">
</head><body class="post"><div id="fb-root"></div><div class="wrap"><header><nav class="navi-post"><a class="navi-post-back" href="javascript:history.back()"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="navi-post-home" href="/"><i class="fa fa-home" aria-hidden="true"></i></a></nav></header><main class="post"><div class="post"><article class="post-block"><h1 class="post-title">나의 NPM 패키지 만들기</h1><div class="post-info"><div class="post-info-profile"><a href="https://github.com/bbonkr" target="_blank"><img src="/images/me.png"></a></div><div class="post-info-details"><div class="post-categories"><a href="/categories/HowTo" target="_self"><span>HOWTO</span></a></div><div class="post-date">2020년 4월 25일</div></div></div><div class="post-share"><div class="fb-like" data-href="http://bbon.me/2020/04/25/publish-my-npm-package/" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="false">                 </div><div class="fb-share-button" data-href="http://bbon.me/2020/04/25/publish-my-npm-package/" data-layout="button" data-size="small" data-mobile-iframe="true"></div></div><div class="post-content"><p>자주 사용되는 기능을 Typescript 로 작성해서 NPM 에 게시한 후 다른 프로젝트에서 사용하고 싶어 NPM 에 패키지를 어떻게 공개하는지를 확인했습니다.</p>
<p>저는 <code>@bbon</code> 스코프를 사용해서 <code>@bbon/formatter</code> 패키지를 게시할 것입니다.</p>
<blockquote>
<p><a href="https://docs.npmjs.com/using-npm/scope.html" target="_blank" rel="noopener">스코프 npm-scope</a> 페이지에서 정보를 확인할 수 있습니다.</p>
</blockquote>
<p>npm 패키지는 이름이 고유해야 하는데, 약 1,268,126 개의 공개된 패키지 (2020-04-25 현재) 가 존재하는 상태에서 패키지 이름을 결정하는 것은 매우 어렵습니다만, 스코프를 사용하면 원하는 패키지 이름을 사용할 수 있다고 생각되었습니다.</p>
<p>따라하면서 패키지를 게시하시려면 아래 내용을 확인하기 전에 <a href="https://www.npmjs.com/" target="_blank" rel="noopener">npm</a> 계정을 만들고 시작하는 것을 제안합니다.</p>
<h2 id="프로젝트-구성"><a href="#프로젝트-구성" class="headerlink" title="프로젝트 구성"></a>프로젝트 구성</h2><p>GitHub 에 저장소를 만들고, 로컬 저장소로 복제한 후 시작합니다.</p>
<h3 id="프로젝트-초기화"><a href="#프로젝트-초기화" class="headerlink" title="프로젝트 초기화"></a>프로젝트 초기화</h3><p>프로젝트를 초기화합니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> init<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>package.json</code> 파일을 편집기로 열고 필요한 정보를 편집합니다.</p>
<blockquote>
<p><a href="https://github.com/bbonkr/bbon-formatter/blob/master/package.json" target="_blank" rel="noopener">package.json</a> 파일을 확인하십시오.</p>
</blockquote>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"@bbon/formatter"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Format the entered values."</span><span class="token punctuation">,</span>
  <span class="token property">"repository"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"git"</span><span class="token punctuation">,</span>
    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"git+https://github.com/bbonkr/bbon-formatter.git"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"homepage"</span><span class="token operator">:</span> <span class="token string">"https://github.com/bbonkr/bbon-formatter"</span><span class="token punctuation">,</span>
  <span class="token property">"bugs"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"https://github.com/bbonkr/bbon-formatter/issues"</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"formatting"</span><span class="token punctuation">,</span> <span class="token string">"string"</span><span class="token punctuation">,</span> <span class="token string">"utility"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"Pon Cheol Ku &lt;dev@bbon.kr> (http://bbon.kr)"</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"MIT"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>package.json 파일의 명세는 <a href="https://docs.npmjs.com/files/package.json" target="_blank" rel="noopener">npm-package.json</a> 페이지에서 확인할 수 있습니다.</p>
</blockquote>
<h3 id="프로젝트-설정"><a href="#프로젝트-설정" class="headerlink" title="프로젝트 설정"></a>프로젝트 설정</h3><p>기능을 구현하기 위해서 타입스크립트를 사용합니다.</p>
<p>코드 작성 규칙 지정을 위해 eslint, prettier 를 사용합니다.</p>
<p>단위테스트는 jest를 사용합니다.</p>
<p>의존 패키지를 설치합니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> --save-dev typescript eslint prettier @typescript-eslint/eslint-plugin @typescript-eslint/parser eslint-config-prettier eslint-plugin-import eslint-plugin-prettier jest @types/jest @types/node ts-jest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>.prettierrc</code> 파일을 만들고, 구성 내용을 입력합니다.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"semi"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"trailingComma"</span><span class="token operator">:</span> <span class="token string">"all"</span><span class="token punctuation">,</span>
  <span class="token property">"singleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"printWidth"</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token property">"tabWidth"</span><span class="token operator">:</span> <span class="token number">4</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>.eslintrc</code> 파일을 만들고, 구성 내용을 입력합니다.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"parser"</span><span class="token operator">:</span> <span class="token string">"@typescript-eslint/parser"</span><span class="token punctuation">,</span>
  <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"@typescript-eslint"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"plugin:@typescript-eslint/recommended"</span><span class="token punctuation">,</span>
    <span class="token string">"prettier"</span><span class="token punctuation">,</span>
    <span class="token string">"prettier/@typescript-eslint"</span><span class="token punctuation">,</span>
    <span class="token string">"plugin:prettier/recommended"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"parserOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"ecmaVersion"</span><span class="token operator">:</span> <span class="token number">2018</span><span class="token punctuation">,</span> <span class="token comment">// Allows for the parsing of modern ECMAScript features</span>
    <span class="token property">"sourceType"</span><span class="token operator">:</span> <span class="token string">"module"</span> <span class="token comment">// Allows for the use of imports</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"no-console"</span><span class="token operator">:</span> <span class="token string">"warn"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>.eslintignore</code> 파일을 만들고 내용을 편집합니다.</p>
<pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">dist&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>.gitignore 파일을 만들고 내용을 편집합니다.</p>
<pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">node_modules&#x2F;
dist&#x2F;
.jest&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="타입스크립트-프로젝트-추가"><a href="#타입스크립트-프로젝트-추가" class="headerlink" title="타입스크립트 프로젝트 추가"></a>타입스크립트 프로젝트 추가</h3><p><code>tsc --init</code> 명령으로 타입스크립트 프로젝트 파일 <code>tsconfig.json</code>을 추가합니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ npx tsc --init<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>tsconfig.json 파일의 명세는 <a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html" target="_blank" rel="noopener">tsconfig.json - typescript</a> 페이지에서 확인할 수 있습니다.</p>
</blockquote>
<p>만들어진 <code>tsocnfig.json</code> 파일의 내용을 편집합니다.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/* Basic Options */</span>
    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"es5"</span><span class="token punctuation">,</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"commonjs"</span><span class="token punctuation">,</span>
    <span class="token property">"declaration"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"outDir"</span><span class="token operator">:</span> <span class="token string">"./dist"</span><span class="token punctuation">,</span>
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"esModuleInterop"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"forceConsistentCasingInFileNames"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token property">"exclude"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"__test__"</span><span class="token punctuation">,</span> <span class="token string">"./**/*.spec.ts"</span><span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="코드-작성"><a href="#코드-작성" class="headerlink" title="코드 작성"></a>코드 작성</h3><p>src 디렉터리를 만들고 코드를 작성합니다.</p>
<p><code>src/StringFormatter.ts</code> 파일의 내용입니다.</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">/**
 * 포맷팅 기능을 제공합니다.
 *
 * @export
 * @class StringFormatter
 */</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">StringFormatter</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">/**
   * 숫자에 1000 단위 구분자를 추가해서 문자열로 출력합니다.
   *
   * @param &#123;(number | string)&#125; value
   * @param &#123;string&#125; delimiter 구분자; 기본값: **,** 콤마 문자
   * @returns &#123;string&#125;
   * @memberof StringFormatter
   */</span>
  <span class="token keyword">public</span> <span class="token function">NumberWithDelimiter</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">,</span> delimiter <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> stringValue <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> fraction <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">"number"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      stringValue <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      stringValue <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>stringValue<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> splittedValue <span class="token operator">=</span> stringValue<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>splittedValue<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        stringValue <span class="token operator">=</span> splittedValue<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        fraction <span class="token operator">=</span> splittedValue<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    stringValue <span class="token operator">=</span> stringValue<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\B(?=(\d&#123;3&#125;)+(?!\d))/g</span><span class="token punctuation">,</span> delimiter<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>stringValue<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>fraction <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>fraction<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">""</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>src/index.ts</code> 파일의 내용입니다.</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token punctuation">&#123;</span> StringFormatter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./StringFormatter"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="단위테스트-추가"><a href="#단위테스트-추가" class="headerlink" title="단위테스트 추가"></a>단위테스트 추가</h3><p><code>src/StringFormatter.spec.ts</code> 파일의 내용입니다.</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> StringFormatter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./StringFormatter"</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"StringFormatter"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> formatter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringFormatter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"세자리마다 구분자가 추가된 숫자 형식의 문자열"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>formatter<span class="token punctuation">.</span><span class="token function">NumberWithDelimiter</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">"1,000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"큰 숫자도 세자리마다 구분자가 추가된 숫자 형식의 문자열"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>formatter<span class="token punctuation">.</span><span class="token function">NumberWithDelimiter</span><span class="token punctuation">(</span><span class="token number">12345678901234</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>
      <span class="token string">"12,345,678,901,234"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"소수점 아래 값은 구분자가 추가되지 않습니다."</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>formatter<span class="token punctuation">.</span><span class="token function">NumberWithDelimiter</span><span class="token punctuation">(</span><span class="token number">1000.1234</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">"1,000.1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"숫자형식의 문자열을 입력하면 세자리마다 구분자가 추가된 숫자 형식의 문자열"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>formatter<span class="token punctuation">.</span><span class="token function">NumberWithDelimiter</span><span class="token punctuation">(</span><span class="token string">"1000"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">"1,000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"숫자형식의 문자열을 입력하면 소수점 아래 값은 구분자가 추가되지 않습니다."</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>formatter<span class="token punctuation">.</span><span class="token function">NumberWithDelimiter</span><span class="token punctuation">(</span><span class="token string">"1000.1234"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">"1,000.1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"빈 분자열은 빈 문자열을 반환합니다."</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>formatter<span class="token punctuation">.</span><span class="token function">NumberWithDelimiter</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>jest 구성내용을 package.json 파일에 추가합니다.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token comment">// ... 이전 내용</span>
  <span class="token property">"jest"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"transform"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"^.+\\.(ts|tsx)$"</span><span class="token operator">:</span> <span class="token string">"ts-jest"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"globals"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"ts-jest"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"tsConfig"</span><span class="token operator">:</span> <span class="token string">"tsconfig.json"</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"testRegex"</span><span class="token operator">:</span> <span class="token string">"\\.(test|spec)\\.((js|ts))$"</span><span class="token punctuation">,</span>
    <span class="token property">"setupFilesAfterEnv"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./__test__/setup.ts"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"cacheDirectory"</span><span class="token operator">:</span> <span class="token string">"./.jest/cache"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="NPM-스크립트"><a href="#NPM-스크립트" class="headerlink" title="NPM 스크립트"></a>NPM 스크립트</h2><p>빌드, 린트, 테스트 스크립트를 추가합니다.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token comment">// ... 이전내용</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"jest"</span><span class="token punctuation">,</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"tsc"</span><span class="token punctuation">,</span>
    <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"eslint ./src/**/*.ts"</span><span class="token punctuation">,</span>
    <span class="token property">"lint:fix"</span><span class="token operator">:</span> <span class="token string">"eslint ./src/**/*.ts --fix"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>빌드 스크립트 실행 명령은 아래와 같습니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> run build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>빌드 스크립트를 실행하면 dist 디렉터리가 만들어지고, dist 디렉터리에 타입스크립트로 작성한 코드에서 트랜스파일된 <code>StringFormatter.js</code>, <code>index.js</code>, <code>StringFormatter.d.ts</code>, <code>index.d.ts</code> 파일이 만들어 집니다.</p>
<p>테스트 스크립트 실행 명령은 아래와 같습니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> run <span class="token builtin class-name">test</span>

<span class="token operator">></span> @bbon/formatter@1.0.1 <span class="token builtin class-name">test</span> D:<span class="token punctuation">\</span>repos<span class="token punctuation">\</span>formatter
<span class="token operator">></span> jest

 PASS  src/StringFormatter.spec.ts
  StringFormatter
    √ 세자리마다 구분자가 추가된 숫자 형식의 문자열 <span class="token punctuation">(</span>1ms<span class="token punctuation">)</span>
    √ 큰 숫자도 세자리마다 구분자가 추가된 숫자 형식의 문자열
    √ 소수점 아래 값은 구분자가 추가되지 않습니다. <span class="token punctuation">(</span>1ms<span class="token punctuation">)</span>
    √ 숫자형식의 문자열을 입력하면 세자리마다 구분자가 추가된 숫자 형식의 문자열
    √ 숫자형식의 문자열을 입력하면 소수점 아래 값은 구분자가 추가되지 않습니다.
    √ 빈 분자열은 빈 문자열을 반환합니다.

Test Suites: <span class="token number">1</span> passed, <span class="token number">1</span> total
Tests:       <span class="token number">6</span> passed, <span class="token number">6</span> total
Snapshots:   <span class="token number">0</span> total
Time:        <span class="token number">1</span>.646s, estimated 3s
Ran all <span class="token builtin class-name">test</span> suites.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="NPM-패키지-게시-준비"><a href="#NPM-패키지-게시-준비" class="headerlink" title="NPM 패키지 게시 준비"></a>NPM 패키지 게시 준비</h2><p>NPM 패키지를 게시하기 전에 패키지에 포함될 파일을 지정합니다.</p>
<p>패키지를 사용하는 분의 입장에서 필요없는 파일은 제외하고, 꼭 필요한 파일만 전달하는 것이 좋겠습니다.</p>
<p>현재 구성된 프로젝트를 빌드하면 dist 디렉터리가 만들어지고, 타입스크립트로 작성된 코드의 트랜스파일 결과가 저장됩니다.</p>
<p>따라서, dist 디렉터리의 내용은 NPM 패키지에 꼭 포함되어야 합니다.</p>
<p>다른 유명한 패키지의 내용을 확인해보니, 패키지 정보와 라이선스 정보도 포함하고 있습니다.</p>
<p>필요한 파일만 전달되도록 구성하기 위해 <code>.npmignore</code> 파일을 만들고 내용을 편집합니다.</p>
<p><code>.npmignore</code> 파일의 내용입니다.</p>
<pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">__test__&#x2F;
src&#x2F;
.jest&#x2F;
.eslintignore
.eslintrc
.prettierrc
tsconfig.json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>npm 패키지에서 제외하는 이유는 아래와 같습니다.</p>
<p>__test__ 디렉터리는 jest 전역 구성을 위한 코드가 있습니다.</p>
<p>src 디렉터리는 타입스크립트로 작성된 소스코드가 있습니다.</p>
<p>.jest 디렉터리는 jest 테스트의 캐시 파일이 있습니다.</p>
<p>npm 패키지 정보에 메인 파일이름과 형식 파일이름을 추가합니다.</p>
<p>package.json 파일의 내용입니다.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token comment">// ...이전 내용</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"dist/index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"types"</span><span class="token operator">:</span> <span class="token string">"dist/index.d.ts"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="NPM-패키지-게시"><a href="#NPM-패키지-게시" class="headerlink" title="NPM 패키지 게시"></a>NPM 패키지 게시</h2><p>npm 패키지를 게시하기 위해 인증 정보를 저장합니다.</p>
<p><code>npm login</code> 명령으로 인증정보를 저장할 수 있습니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> login<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>계정이름, 비밀번호, 전자우편주소, 다중인증을 사용중이면 다중인증정보를 입력하면 인증정보가 저장됩니다.</p>
<p><code>npm config ls</code> 명령으로 정보를 확인할 수 있습니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> config <span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>로그인이 되었으면, 준비해둔 npm 스크립트로 빌드합니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> run build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>dist 디렉터리에 파일 작성된 것을 확인합니다.</p>
<h3 id="NPM-패키지-최초-게시"><a href="#NPM-패키지-최초-게시" class="headerlink" title="NPM 패키지 최초 게시"></a>NPM 패키지 최초 게시</h3><p>문제가 없으면 npm publish 명령으로 게시합니다.</p>
<p>이 때, 스코프 패키지는 기본적으로 비공개 패키지로 게시됩니다. 저는 공개 패키지로 게시할 것이므로 <code>--access public</code> 옵션을 사용합니다.</p>
<pre class="line-numbers language-none"><code class="language-none">$ npm publish --access public<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>정상적으로 게시되면 npm 사이트에서 게시된 패키지를 확인할 수 있습니다.</p>
<p><a href="https://www.npmjs.com/package/@bbon/formatter" target="_blank" rel="noopener">@bbon/formatter</a> 페이지와 같이 정보가 제공됩니다.</p>
<h3 id="NPM-패키지-판올림"><a href="#NPM-패키지-판올림" class="headerlink" title="NPM 패키지 판올림"></a>NPM 패키지 판올림</h3><p>이후 변경된 내용으로 NPM 패키지를 업데이트하려면 package.json 파일의 버전을 변경해서 게시해야 합니다.</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;
    &#x2F;&#x2F; ... 이전내용
    &quot;version&quot;: &quot;1.0.1&quot;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>빌드 스크립트를 실행해서 변경된 내용을 dist 디렉터리 파일에 반영합니다.</p>
<p>문제가 없으면 npm publish 명령으로 게시합니다.</p>
<p>이 때, 스코프 패키지는 기본적으로 비공개 패키지로 게시됩니다. 저는 공개 패키지로 게시할 것이므로 <code>--access public</code> 옵션을 사용합니다.</p>
<pre class="line-numbers language-none"><code class="language-none">$ npm publish --access public<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><a href="https://docs.npmjs.com/creating-and-publishing-scoped-public-packages" target="_blank" rel="noopener">Creating and publishing scoped public packages</a> 페이지에서 관련 정보를 확인할 수 있습니다.</p>
</blockquote>
<p>정상적으로 게시되면 npm 사이트에서 게시된 패키지를 확인할 수 있습니다.</p>
<p><a href="https://www.npmjs.com/package/@bbon/formatter" target="_blank" rel="noopener">@bbon/formatter</a> 페이지와 같이 정보가 제공됩니다.</p>
<h2 id="NPM-패키지-사용"><a href="#NPM-패키지-사용" class="headerlink" title="NPM 패키지 사용"></a>NPM 패키지 사용</h2><p>게시한 NPM 패키지는 다른 패키지 사용과 동일하게 사용할 수 있습니다.</p>
<p>새로은 프로젝트를 준비하고, 아래 명령으로 패키지를 설치합니다.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> --save @bbon/formatter<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>설치된 패키지의 내용을 확인합니다.</p>
<blockquote>
<p>node_modules/@bbon/formatter 디렉터리에서 확인할 수 있습니다.</p>
</blockquote>
<p>dist 디렉터리와 라이선스 파일, 패키지 정보, README.md 파일만 포함되어 있음을 확인할 수 있습니다.</p>
<pre class="line-numbers language-plaintext" data-language="plaintext"><code class="language-plaintext">프로젝트 디렉터리
│  index.js
│  package-lock.json
│  package.json
│
└─node_modules
    └─@bbon
        └─formatter
            │  LICENSE
            │  package.json
            │  README.md
            │
            └─dist
                    index.d.ts
                    index.js
                    StringFormatter.d.ts
                    StringFormatter.js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="마침"><a href="#마침" class="headerlink" title="마침"></a>마침</h2><p>전체 코드는 <a href="https://github.com/bbonkr/bbon-formatter" target="_blank" rel="noopener">GitHub: bbon-formatter</a> 에서 확인할 수 있습니다.</p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2020/03/24/%EA%B3%B5%EC%A0%81-%EB%A7%88%EC%8A%A4%ED%81%AC-%EC%95%88%EB%82%B4/"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="next" href="/2020/06/01/wsl-2-windows-10-build-2004/"><i class="fa fa-arrow-right" aria-hidden="true"></i></a></div><div class="copyright"><p>© 2019 - 2021 <a href="https://github.com/bbonkr" target="_blank">bbon</a>. Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/stunstunstun/hexo-theme-chiangmai" target="_blank">hexo-theme-chiangmai</a>.</p></div></footer></div><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create','UA-64779499-1','auto');ga('send','pageview');</script></body></html>