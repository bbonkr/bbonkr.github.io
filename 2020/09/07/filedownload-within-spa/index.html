<!DOCTYPE html><html lang="ko" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>SPA 에서 파일 다운로드 · {bbon}</title><meta name="description"><meta name="og:title" content="SPA 에서 파일 다운로드"><meta name="og:type" content="website"><meta name="og:url" content="http://bbon.me/2020/09/07/filedownload-within-spa/"><meta name="og:image" content="/images/logo.png"><meta name="og:description"><meta name="twitter:card" content="summary"><meta name="witter:site" content="@bbonkr"><meta name="witter:creator" content="@bbonkr"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/chiangmai.css"><link rel="stylesheet" href="/css/prism.css"><link rel="search" type="application/opensearchdescription+xml" href="http://bbon.me/atom.xml" title="{bbon}"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="{bbon}" type="application/atom+xml">
</head><body class="post"><div id="fb-root"></div><div class="wrap"><header><nav class="navi-post"><a class="navi-post-back" href="javascript:history.back()"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="navi-post-home" href="/"><i class="fa fa-home" aria-hidden="true"></i></a></nav></header><main class="post"><div class="post"><article class="post-block"><h1 class="post-title">SPA 에서 파일 다운로드</h1><div class="post-info"><div class="post-info-profile"><a href="https://github.com/bbonkr" target="_blank"><img src="/images/me.png"></a></div><div class="post-info-details"><div class="post-categories"><a href="/categories/HowTo" target="_self"><span>HOWTO</span></a></div><div class="post-date">2020년 9월 7일</div></div></div><div class="post-share"><div class="fb-like" data-href="http://bbon.me/2020/09/07/filedownload-within-spa/" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="false">                 </div><div class="fb-share-button" data-href="http://bbon.me/2020/09/07/filedownload-within-spa/" data-layout="button" data-size="small" data-mobile-iframe="true"></div></div><div class="post-content"><p>SPA <small>Single Page Application</small> 로 작성중인 웹 응용프로그램에서 파일 다운로드를 구현할 때, 새 창으로 다운로드할 파일의 URI를 제공해서 처리하면 매우 편리하게 파일을 다운로드할 수 있습니다.</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> fileDownloadUri <span class="token operator">=</span> <span class="token string">'파일 다운로드 URI'</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>fileDownloadUri<span class="token punctuation">,</span> <span class="token string">'_blank'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>파일 URI와 함께 인증이 필요할 때, 쿠키를 사용중이면 동일하게 사용하면 됩니다.</p>
<p>그런데, 쿠키를 사용하지 않고, JWT 등을 사용해서 요청 헤더에 데이터를 제공하는 형식으로 인증을 처리중이면, 새창을 열어서 처리하는 방식으로는 처리가 불가능합니다.</p>
<p>이 때, 사용할 수 있는 간단한 코드조각을 npm 패키지로 공유합니다.</p>
<h2 id="📢-bbon-filedownload-패키지"><a href="#📢-bbon-filedownload-패키지" class="headerlink" title="📢 @bbon/filedownload 패키지"></a>📢 @bbon/filedownload 패키지</h2><p><a href="https://www.npmjs.com/package/@bbon/filedownload" target="_blank" rel="noopener">npm: @bbon/filedownload 패키지</a> 페이지에서 패키지를 확인하실 수 있습니다.</p>
<h2 id="🛠-설치"><a href="#🛠-설치" class="headerlink" title="🛠 설치"></a>🛠 설치</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> @bbon/filedownload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">yarn</span> <span class="token function">add</span> @bbon/filedownload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="🎮-사용"><a href="#🎮-사용" class="headerlink" title="🎮 사용"></a>🎮 사용</h2><p>HTTP 요청은 사용중인 패키지 또는 API를 사용하시면 됩니다.</p>
<p>응답 형식은 <code>BLOB</code> 으로 지정되어야 합니다.</p>
<p>AWS S3, Azure Storage, Google Cloud Storage 등의 클라우드 객체 저장소에 사용이 가능합니다.<br>물론, 직접 구현한 웹 응용프로그램의 BLOB 응답에도 사용가능합니다.</p>
<p>예제 코드에서 HTTP 요청은 <a href="https://www.npmjs.com/package/axios" target="_blank" rel="noopener">Axios 패키지</a>를 사용합니다.</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> requestConfig<span class="token operator">:</span> AxiosRequestConfig <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">...</span>Axios<span class="token punctuation">.</span>defaults<span class="token punctuation">,</span>
    responseType<span class="token operator">:</span> <span class="token string">'blob'</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

Axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>fileDownloadUrl<span class="token punctuation">,</span> requestConfig<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> contentType <span class="token operator">=</span>
                res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-type'</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">'application/octet-stream'</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileDownloadHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            helper<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                data<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                filename<span class="token operator">:</span> fileName<span class="token punctuation">,</span>
                contentType<span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>전체코드는 <a href="https://github.com/bbonkr/bbon-filedownload-sample" target="_blank" rel="noopener">GitHub: bbon-filedownload-sample</a> 저장소에서 확인하실 수 있습니다.</p>
<p><a href="https://bbon.me/bbon-filedownload-sample/">😎 예제 페이지</a>에서 동작을 확인하실 수 있습니다. <small>(다운로드 버튼을 클릭하면, 빨간 이미지를 다운로드합니다. 확인하실 때 눈👁을 조심하십시오.)</small></p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2020/06/01/wsl-2-windows-10-build-2004/"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="next" href="/2020/11/14/migrate-net-core-3-1-project-to-net-5/"><i class="fa fa-arrow-right" aria-hidden="true"></i></a></div><div class="copyright"><p>© 2019 - 2021 <a href="https://github.com/bbonkr" target="_blank">bbon</a>. Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/stunstunstun/hexo-theme-chiangmai" target="_blank">hexo-theme-chiangmai</a>.</p></div></footer></div><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create','UA-64779499-1','auto');ga('send','pageview');</script></body></html>